<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3D Car Racing Game</title>
<style>
body { margin: 0; overflow: hidden; background: black; }
#info {
  position: absolute;
  top: 10px;
  left: 10px;
  color: white;
  font-family: Arial;
  background: rgba(0,0,0,0.5);
  padding: 10px;
  border-radius: 8px;
}
</style>
</head>
<body>

<div id="info">⬆ Forward | ⬅ ➡ Turn</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.150/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.150/examples/js/loaders/GLTFLoader.js"></script>

<script>
let scene, camera, renderer, car;
let speed = 0;
let keys = {};

scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb);

camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0, 5, 10);

renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Light
const light = new THREE.DirectionalLight(0xffffff, 1);
light.position.set(5,10,5);
scene.add(light);
scene.add(new THREE.AmbientLight(0xffffff,0.5));

// Road
const road = new THREE.Mesh(
  new THREE.PlaneGeometry(20, 200),
  new THREE.MeshStandardMaterial({color: 0x555555})
);
road.rotation.x = -Math.PI/2;
scene.add(road);

// Center line
const line = new THREE.Mesh(
  new THREE.PlaneGeometry(0.2, 200),
  new THREE.MeshStandardMaterial({color: 0xffffff})
);
line.rotation.x = -Math.PI/2;
line.position.y = 0.01;
scene.add(line);

// Edge stripes
function createEdge(x){
  const edge = new THREE.Mesh(
    new THREE.PlaneGeometry(0.5,200),
    new THREE.MeshStandardMaterial({color: 0xff0000})
  );
  edge.rotation.x = -Math.PI/2;
  edge.position.set(x,0.02,0);
  scene.add(edge);

  const white = new THREE.Mesh(
    new THREE.PlaneGeometry(0.5,200),
    new THREE.MeshStandardMaterial({color: 0xffffff})
  );
  white.rotation.x = -Math.PI/2;
  white.position.set(x+0.5,0.02,0);
  scene.add(white);
}
createEdge(-10);
createEdge(9);

// Buildings
function createBuildings(x){
  for(let i=0;i<20;i++){
    const b = new THREE.Mesh(
      new THREE.BoxGeometry(3,Math.random()*10+5,3),
      new THREE.MeshStandardMaterial({color: 0x888888})
    );
    b.position.set(x, b.geometry.parameters.height/2, -i*10);
    scene.add(b);
  }
}
createBuildings(-13);
createBuildings(13);

// Street lights
for(let i=0;i<20;i++){
  const pole = new THREE.Mesh(
    new THREE.CylinderGeometry(0.1,0.1,5),
    new THREE.MeshStandardMaterial({color:0x333333})
  );
  pole.position.set(7,2.5,-i*10);
  scene.add(pole);

  const lamp = new THREE.PointLight(0xffffcc,1,10);
  lamp.position.set(7,5,-i*10);
  scene.add(lamp);
}

// Traffic Light
const trafficPole = new THREE.Mesh(
  new THREE.CylinderGeometry(0.15,0.15,5),
  new THREE.MeshStandardMaterial({color:0x000000})
);
trafficPole.position.set(2,2.5,-30);
scene.add(trafficPole);

const redLight = new THREE.Mesh(
  new THREE.SphereGeometry(0.3),
  new THREE.MeshStandardMaterial({color:0xff0000})
);
redLight.position.set(2,5,-30);
scene.add(redLight);

// Load 3D Car Model
const loader = new THREE.GLTFLoader();
loader.load(
  "https://threejs.org/examples/models/gltf/ferrari.glb",
  function(gltf){
    car = gltf.scene;
    car.scale.set(0.5,0.5,0.5);
    car.position.set(0,0,-5);
    scene.add(car);
  }
);

// Controls
window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

function animate(){
  requestAnimationFrame(animate);

  if(car){
    if(keys["ArrowUp"]) speed = 0.2;
    else speed = 0;

    if(keys["ArrowLeft"]) car.position.x += 0.1;
    if(keys["ArrowRight"]) car.position.x -= 0.1;

    car.position.z -= speed;

    camera.position.z = car.position.z + 10;
    camera.position.x = car.position.x;
    camera.lookAt(car.position);
  }

  renderer.render(scene,camera);
}
animate();

window.addEventListener("resize",()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>

</body>
</html>
